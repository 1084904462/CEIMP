<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>
    <title>修改密码</title>
    <link rel="stylesheet" th:href="@{/css/plugins/font-awesome/css/font-awesome.min.css}"/>
    <link rel="stylesheet" th:href="@{/plugins/layui/css/layui.css}"/>
    <link rel="stylesheet" th:href="@{/css/scholarship.css}"/>
</head>
<body>
    <!--上方-->
    <div class="scholarship-header">
        <div class="scholarship-logo">
            信息与电子工程学院 奖学金申报系统
        </div>
        <ul class="layui-nav layui-layout-right">
            <li class="layui-nav-item">
                <a href="javascript:;" th:text="${session.userssBean.userId}"></a>
                <dl class="layui-nav-child">
                    <dd>
                        <a href="changePassword">修改密码</a>
                    </dd>
                    <dd>
                        <a href="/uLogout">退出</a>
                    </dd>
                </dl>
            </li>
        </ul>
    </div>

    <div class="layui-container" th:object="${session.userssBean}">
        <div class="layui-row layui-col-space5" th:if="*{isChangedPassword == 1}">
            <div class="layui-col-lg-offset3 layui-col-lg9 layui-col-md-offset3 layui-col-md9">
                <div class="scholarship-title">
                    修改密码
                </div>
            </div>
        </div>
        <div class="layui-row" th:if="*{isChangedPassword == 1}">
            <div class="layui-col-lg3 layui-col-md3">
                <ul class="layui-timeline">
                    <li class="layui-timeline-item">
                        <i class="layui-icon layui-timeline-axis">&#xe63f;</i>
                        <div class="layui-timeline-content">
                            <a href="nationalInspirationalScholarship" class="scholarship-link">
                                <div class="layui-timeline-title">国家励志奖学金</div>
                            </a>
                        </div>
                    </li>
                    <li class="layui-timeline-item">
                        <i class="layui-icon layui-timeline-axis">&#xe63f;</i>
                        <div class="layui-timeline-content">
                            <a href="nationalGrant" class="scholarship-link">
                                <div class="layui-timeline-title">国家助学金</div>
                            </a>
                        </div>
                    </li>
                    <li class="layui-timeline-item">
                        <i class="layui-icon layui-timeline-axis">&#xe63f;</i>
                        <div class="layui-timeline-content">
                            <a href="provincialGovernmentScholarship" class="scholarship-link">
                                <div class="layui-timeline-title">省政府奖学金</div>
                            </a>
                        </div>
                    </li>
                    <li class="layui-timeline-item">
                        <i class="layui-icon layui-timeline-axis">&#xe63f;</i>
                        <div class="layui-timeline-content">
                            <a href="schoolScholarship" class="scholarship-link">
                                <div class="layui-timeline-title">校奖学金</div>
                            </a>
                        </div>
                    </li>
                    <li class="layui-timeline-item">
                        <i class="layui-icon layui-timeline-axis">&#xe63f;</i>
                        <div class="layui-timeline-content">
                            <a href="tripleAStudent" class="scholarship-link">
                                <div class="layui-timeline-title">三好学生</div>
                            </a>
                        </div>
                    </li>
                </ul>
            </div>
            <div class="layui-col-lg9 layui-col-md9">
                <form action="changedPassword" class="layui-form layui-form-pane change-form" method="post">
                    <div class="layui-form-item">
                        <label class="layui-form-label">旧密码</label>
                        <div class="layui-input-inline">
                            <input type="password" name="oldPassword" id="oldPassword" required="required" lay-verify="required" placeholder="请输入密码" autocomplete="off" class="layui-input"/>
                        </div>
                        <div class="layui-form-mid layui-word-aux"></div>
                    </div>
                    <div class="layui-form-item">
                        <label class="layui-form-label">新密码</label>
                        <div class="layui-input-inline">
                            <input type="password" name="newPassword" id="newPassword" required="required" lay-verify="required|newPassword" placeholder="请输入密码（6-16位）" autocomplete="off" class="layui-input"/>
                        </div>
                        <div class="layui-form-mid layui-word-aux"></div>
                    </div>
                    <div class="layui-form-item">
                        <label class="layui-form-label">再次输入</label>
                        <div class="layui-input-inline">
                            <input type="password" name="confirmPassword" id="confirmPassword" required="required" lay-verify="required|newPassword" placeholder="请输入密码" autocomplete="off" class="layui-input"/>
                        </div>
                        <div class="layui-form-mid layui-word-aux"></div>
                    </div>
                    <div class="layui-form-item">
                        <div class="layui-input-block">
                            <button class="layui-btn layui-btn-normal" lay-submit="lay-submit" lay-filter="change">提交</button>
                        </div>
                    </div>
                </form>
            </div>
        </div>




        <div class="layui-row" th:if="*{isChangedPassword == 0}">
            <div class="layui-col-lg-offset2 layui-col-lg8 layui-col-md-offset2 layui-col-md8">
                <div class="scholarship-title">
                    修改密码
                </div>
            </div>
        </div>
        <div class="layui-row" th:if="*{isChangedPassword == 0}">
            <div class="layui-col-lg-offset2 layui-col-lg8 layui-col-md-offset2 layui-col-md8">
                <form action="changedPassword" class="layui-form layui-form-pane change-form" method="post">
                    <div class="layui-form-item">
                        <label class="layui-form-label">旧密码</label>
                        <div class="layui-input-inline">
                            <input type="password" name="oldPassword" id="oldPassword" required="required" lay-verify="required" placeholder="请输入密码" autocomplete="off" class="layui-input"/>
                        </div>
                        <div class="layui-form-mid layui-word-aux"></div>
                    </div>
                    <div class="layui-form-item">
                        <label class="layui-form-label">新密码</label>
                        <div class="layui-input-inline">
                            <input type="password" name="newPassword" id="newPassword" required="required" lay-verify="required|newPassword" placeholder="请输入密码（6-16位）" autocomplete="off" class="layui-input"/>
                        </div>
                        <div class="layui-form-mid layui-word-aux"></div>
                    </div>
                    <div class="layui-form-item">
                        <label class="layui-form-label">再次输入</label>
                        <div class="layui-input-inline">
                            <input type="password" name="confirmPassword" id="confirmPassword" required="required" lay-verify="required|newPassword" placeholder="请输入密码" autocomplete="off" class="layui-input"/>
                        </div>
                        <div class="layui-form-mid layui-word-aux"></div>
                    </div>
                    <div class="layui-form-item">
                        <div class="layui-input-block">
                            <button class="layui-btn layui-btn-normal" lay-submit="lay-submit" lay-filter="change">提交</button>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>


</body>
<script th:src="@{/js/plugins/jquery-3.1.1.min.js}"/>
<script th:src="@{/js/plugins/html5shiv.min.js}"/>
<script th:src="@{/plugins/layui/layui.js}"/>
<script type="text/javascript" th:inline="javascript" th:if="${session.userssBean.isChangedPassword == 0}">
    layui.use(['layer'], function()
    {
        var layer = layui.layer;

        layer.open({
            title: '提示',
            icon: 0,
            content: '第一次登录请务必修改密码！'
        });
    });
</script>
<script type="text/javascript" th:inline="javascript" th:if="${changePasswordBean}">
    /*<![CDATA[*/
    layui.use(['layer'], function()
    {
        var layer = layui.layer;

        var msg = /*[[${changePasswordBean.status}]]*/;

        layer.msg(msg, {icon: 2, anim: 6});

        if(msg == "旧密码输入错误")
        {
            $("#oldPassword").addClass("layui-form-danger").focus();
        }
    });
    /*]]>*/
</script>
<script type="text/javascript">
    /*<![CDATA[*/
    layui.use(['form', 'element'], function()
    {
        var element = layui.element;
        var form = layui.form;

        form.verify({
            newPassword: function(value, item)
            {
                if(!((value.length >= 6) && (value.length <= 16)))
                {
                    return "新密码要求6-16位";
                }
            }
        });

        form.on('submit(change)', function(data)
        {
            var $newPassword = $("#newPassword");
            var $confirmPassword = $("#confirmPassword");

            if($newPassword.val() != $confirmPassword.val())
            {
                layer.msg("两次新密码输入不相同", {icon: 2, anim: 6});
                $confirmPassword.addClass('layui-form-danger').focus();
                return false;
            }

            return true;
        });
    });
    /*]]>*/
</script>
</html>
